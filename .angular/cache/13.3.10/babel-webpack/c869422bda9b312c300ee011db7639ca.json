{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/tab_panel.js)\r\n * Version: 21.2.6\r\n * Build date: Tue Mar 01 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { getOuterHeight } from \"../core/utils/size\";\nimport $ from \"../core/renderer\";\nimport { touch } from \"../core/utils/support\";\nimport { extend } from \"../core/utils/extend\";\nimport devices from \"../core/devices\";\nimport domAdapter from \"../core/dom_adapter\";\nimport registerComponent from \"../core/component_registrator\";\nimport MultiView from \"./multi_view\";\nimport Tabs from \"./tabs\";\nimport { default as TabPanelItem } from \"./tab_panel/item\";\nimport { getImageContainer } from \"../core/utils/icon\";\nimport { getPublicElement } from \"../core/element\";\nimport { isPlainObject, isDefined } from \"../core/utils/type\";\nimport { BindableTemplate } from \"../core/templates/bindable_template\";\nimport { hasWindow } from \"../core/utils/window\";\nvar TABPANEL_CLASS = \"dx-tabpanel\";\nvar TABPANEL_TABS_CLASS = \"dx-tabpanel-tabs\";\nvar TABPANEL_CONTAINER_CLASS = \"dx-tabpanel-container\";\nvar TABS_ITEM_TEXT_CLASS = \"dx-tab-text\";\nvar TabPanel = MultiView.inherit({\n  _getDefaultOptions: function _getDefaultOptions() {\n    return extend(this.callBase(), {\n      itemTitleTemplate: \"title\",\n      hoverStateEnabled: true,\n      showNavButtons: false,\n      scrollByContent: true,\n      scrollingEnabled: true,\n      onTitleClick: null,\n      onTitleHold: null,\n      onTitleRendered: null,\n      badgeExpr: function badgeExpr(data) {\n        return data ? data.badge : void 0;\n      }\n    });\n  },\n  _defaultOptionsRules: function _defaultOptionsRules() {\n    return this.callBase().concat([{\n      device: function device() {\n        return \"desktop\" === devices.real().deviceType && !devices.isSimulator();\n      },\n      options: {\n        focusStateEnabled: true\n      }\n    }, {\n      device: function device() {\n        return !touch;\n      },\n      options: {\n        swipeEnabled: false\n      }\n    }, {\n      device: {\n        platform: \"generic\"\n      },\n      options: {\n        animationEnabled: false\n      }\n    }]);\n  },\n  _init: function _init() {\n    this.callBase();\n    this.$element().addClass(TABPANEL_CLASS);\n    this.setAria(\"role\", \"tabpanel\");\n  },\n  _initMarkup: function _initMarkup() {\n    this.callBase();\n\n    this._createTitleActions();\n\n    this._renderLayout();\n  },\n  _initTemplates: function _initTemplates() {\n    this.callBase();\n\n    this._templateManager.addDefaultTemplates({\n      title: new BindableTemplate(function ($container, data) {\n        if (isPlainObject(data)) {\n          var $iconElement = getImageContainer(data.icon);\n\n          if ($iconElement) {\n            $container.append($iconElement);\n          }\n\n          if (isDefined(data.title) && !isPlainObject(data.title)) {\n            $container.append(domAdapter.createTextNode(data.title));\n          }\n        } else if (isDefined(data)) {\n          $container.text(String(data));\n        }\n\n        $container.wrapInner($(\"<span>\").addClass(TABS_ITEM_TEXT_CLASS));\n      }, [\"title\", \"icon\"], this.option(\"integrationOptions.watchMethod\"))\n    });\n  },\n  _createTitleActions: function _createTitleActions() {\n    this._createTitleClickAction();\n\n    this._createTitleHoldAction();\n\n    this._createTitleRenderedAction();\n  },\n  _createTitleClickAction: function _createTitleClickAction() {\n    this._titleClickAction = this._createActionByOption(\"onTitleClick\");\n  },\n  _createTitleHoldAction: function _createTitleHoldAction() {\n    this._titleHoldAction = this._createActionByOption(\"onTitleHold\");\n  },\n  _createTitleRenderedAction: function _createTitleRenderedAction() {\n    this._titleRenderedAction = this._createActionByOption(\"onTitleRendered\");\n  },\n  _renderContent: function _renderContent() {\n    var that = this;\n    this.callBase();\n\n    if (this.option(\"templatesRenderAsynchronously\")) {\n      this._resizeEventTimer = setTimeout(function () {\n        that._updateLayout();\n      }, 0);\n    }\n  },\n  _renderLayout: function _renderLayout() {\n    if (this._tabs) {\n      this._updateLayout();\n\n      return;\n    }\n\n    var $element = this.$element();\n    this._$tabContainer = $(\"<div>\").addClass(TABPANEL_TABS_CLASS).appendTo($element);\n    var $tabs = $(\"<div>\").appendTo(this._$tabContainer);\n    this._tabs = this._createComponent($tabs, Tabs, this._tabConfig());\n    this._$container = $(\"<div>\").addClass(TABPANEL_CONTAINER_CLASS).appendTo($element);\n\n    this._$container.append(this._$wrapper);\n\n    this._updateLayout();\n  },\n  _updateLayout: function _updateLayout() {\n    if (hasWindow()) {\n      var tabsHeight = getOuterHeight(this._$tabContainer);\n\n      this._$container.css({\n        marginTop: -tabsHeight,\n        paddingTop: tabsHeight\n      });\n    }\n  },\n  _refreshActiveDescendant: function _refreshActiveDescendant() {\n    if (!this._tabs) {\n      return;\n    }\n\n    var tabs = this._tabs;\n    var tabItems = tabs.itemElements();\n    var $activeTab = $(tabItems[tabs.option(\"selectedIndex\")]);\n    var id = this.getFocusedItemId();\n    this.setAria(\"controls\", void 0, $(tabItems));\n    this.setAria(\"controls\", id, $activeTab);\n  },\n  _tabConfig: function _tabConfig() {\n    return {\n      selectOnFocus: true,\n      focusStateEnabled: this.option(\"focusStateEnabled\"),\n      hoverStateEnabled: this.option(\"hoverStateEnabled\"),\n      repaintChangesOnly: this.option(\"repaintChangesOnly\"),\n      tabIndex: this.option(\"tabIndex\"),\n      selectedIndex: this.option(\"selectedIndex\"),\n      badgeExpr: this.option(\"badgeExpr\"),\n      onItemClick: this._titleClickAction.bind(this),\n      onItemHold: this._titleHoldAction.bind(this),\n      itemHoldTimeout: this.option(\"itemHoldTimeout\"),\n      onSelectionChanged: function (e) {\n        this.option(\"selectedIndex\", e.component.option(\"selectedIndex\"));\n\n        this._refreshActiveDescendant();\n      }.bind(this),\n      onItemRendered: this._titleRenderedAction.bind(this),\n      itemTemplate: this._getTemplateByOption(\"itemTitleTemplate\"),\n      items: this.option(\"items\"),\n      noDataText: null,\n      scrollingEnabled: this.option(\"scrollingEnabled\"),\n      scrollByContent: this.option(\"scrollByContent\"),\n      showNavButtons: this.option(\"showNavButtons\"),\n      itemTemplateProperty: \"tabTemplate\",\n      loopItemFocus: this.option(\"loop\"),\n      selectionRequired: true,\n      onOptionChanged: function (args) {\n        if (\"focusedElement\" === args.name) {\n          if (args.value) {\n            var $value = $(args.value);\n\n            var $newItem = this._itemElements().eq($value.index());\n\n            this.option(\"focusedElement\", getPublicElement($newItem));\n          } else {\n            this.option(\"focusedElement\", args.value);\n          }\n        }\n      }.bind(this),\n      onFocusIn: function (args) {\n        this._focusInHandler(args.event);\n      }.bind(this),\n      onFocusOut: function (args) {\n        if (!this._isFocusOutHandlerExecuting) {\n          this._focusOutHandler(args.event);\n        }\n      }.bind(this)\n    };\n  },\n  _renderFocusTarget: function _renderFocusTarget() {\n    this._focusTarget().attr(\"tabIndex\", -1);\n  },\n  _updateFocusState: function _updateFocusState(e, isFocused) {\n    this.callBase(e, isFocused);\n\n    if (e.target === this._tabs._focusTarget().get(0)) {\n      this._toggleFocusClass(isFocused, this._focusTarget());\n    }\n  },\n  _focusOutHandler: function _focusOutHandler(e) {\n    this._isFocusOutHandlerExecuting = true;\n    this.callBase.apply(this, arguments);\n\n    this._tabs._focusOutHandler(e);\n\n    this._isFocusOutHandlerExecuting = false;\n  },\n  _setTabsOption: function _setTabsOption(name, value) {\n    if (this._tabs) {\n      this._tabs.option(name, value);\n    }\n  },\n  _visibilityChanged: function _visibilityChanged(visible) {\n    if (visible) {\n      this._tabs._dimensionChanged();\n\n      this._updateLayout();\n    }\n  },\n  registerKeyHandler: function registerKeyHandler(key, handler) {\n    this.callBase(key, handler);\n\n    if (this._tabs) {\n      this._tabs.registerKeyHandler(key, handler);\n    }\n  },\n  repaint: function repaint() {\n    this.callBase();\n\n    this._tabs.repaint();\n  },\n  _optionChanged: function _optionChanged(args) {\n    var name = args.name;\n    var value = args.value;\n    var fullName = args.fullName;\n\n    switch (name) {\n      case \"dataSource\":\n        this.callBase(args);\n        break;\n\n      case \"items\":\n        this._setTabsOption(name, this.option(name));\n\n        this._updateLayout();\n\n        if (!this.option(\"repaintChangesOnly\")) {\n          this._tabs.repaint();\n        }\n\n        this.callBase(args);\n        break;\n\n      case \"width\":\n        this.callBase(args);\n\n        this._tabs.repaint();\n\n        break;\n\n      case \"selectedIndex\":\n      case \"selectedItem\":\n        this._setTabsOption(fullName, value);\n\n        this.callBase(args);\n\n        if (true === this.option(\"focusStateEnabled\")) {\n          var selectedIndex = this.option(\"selectedIndex\");\n\n          var selectedTabContent = this._itemElements().eq(selectedIndex);\n\n          this.option(\"focusedElement\", getPublicElement(selectedTabContent));\n        }\n\n        break;\n\n      case \"itemHoldTimeout\":\n      case \"focusStateEnabled\":\n      case \"hoverStateEnabled\":\n        this._setTabsOption(fullName, value);\n\n        this.callBase(args);\n        break;\n\n      case \"scrollingEnabled\":\n      case \"scrollByContent\":\n      case \"showNavButtons\":\n        this._setTabsOption(fullName, value);\n\n        break;\n\n      case \"focusedElement\":\n        var id = value ? $(value).index() : value;\n        var newItem = value ? this._tabs._itemElements().eq(id) : value;\n\n        this._setTabsOption(\"focusedElement\", getPublicElement(newItem));\n\n        this.callBase(args);\n        break;\n\n      case \"itemTitleTemplate\":\n        this._setTabsOption(\"itemTemplate\", this._getTemplateByOption(\"itemTitleTemplate\"));\n\n        break;\n\n      case \"onTitleClick\":\n        this._createTitleClickAction();\n\n        this._setTabsOption(\"onItemClick\", this._titleClickAction.bind(this));\n\n        break;\n\n      case \"onTitleHold\":\n        this._createTitleHoldAction();\n\n        this._setTabsOption(\"onItemHold\", this._titleHoldAction.bind(this));\n\n        break;\n\n      case \"onTitleRendered\":\n        this._createTitleRenderedAction();\n\n        this._setTabsOption(\"onItemRendered\", this._titleRenderedAction.bind(this));\n\n        break;\n\n      case \"loop\":\n        this._setTabsOption(\"loopItemFocus\", value);\n\n        break;\n\n      case \"badgeExpr\":\n        this._invalidate();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _clean: function _clean() {\n    clearTimeout(this._resizeEventTimer);\n    this.callBase();\n  }\n});\nTabPanel.ItemClass = TabPanelItem;\nregisterComponent(\"dxTabPanel\", TabPanel);\nexport default TabPanel;","map":null,"metadata":{},"sourceType":"module"}