{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/form/components/field_item.js)\r\n * Version: 21.2.6\r\n * Build date: Tue Mar 01 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../../../core/renderer\";\nimport eventsEngine from \"../../../events/core/events_engine\";\nimport { name as clickEventName } from \"../../../events/click\";\nimport { getPublicElement } from \"../../../core/element\";\nimport { captionize } from \"../../../core/utils/inflector\";\nimport { format } from \"../../../core/utils/string\";\nimport { isMaterial } from \"../../themes\";\nimport errors from \"../../widget/ui.errors\";\nimport Validator from \"../../validator\";\nimport { FIELD_ITEM_CONTENT_CLASS } from \"../constants\";\nexport var FLEX_LAYOUT_CLASS = \"dx-flex-layout\";\nexport var FIELD_ITEM_OPTIONAL_CLASS = \"dx-field-item-optional\";\nexport var FIELD_ITEM_REQUIRED_CLASS = \"dx-field-item-required\";\nexport var FIELD_ITEM_CONTENT_WRAPPER_CLASS = \"dx-field-item-content-wrapper\";\nexport var FIELD_ITEM_CONTENT_LOCATION_CLASS = \"dx-field-item-content-location-\";\nexport var FIELD_ITEM_LABEL_ALIGN_CLASS = \"dx-field-item-label-align\";\nexport var FIELD_ITEM_HELP_TEXT_CLASS = \"dx-field-item-help-text\";\nexport var LABEL_VERTICAL_ALIGNMENT_CLASS = \"dx-label-v-align\";\nexport var LABEL_HORIZONTAL_ALIGNMENT_CLASS = \"dx-label-h-align\";\nimport { renderLabel } from \"./label\";\nvar TEMPLATE_WRAPPER_CLASS = \"dx-template-wrapper\";\nvar INVALID_CLASS = \"dx-invalid\";\nexport function renderFieldItem(_ref) {\n  var $parent = _ref.$parent,\n      rootElementCssClassList = _ref.rootElementCssClassList,\n      formOrLayoutManager = _ref.formOrLayoutManager,\n      createComponentCallback = _ref.createComponentCallback,\n      useFlexLayout = _ref.useFlexLayout,\n      labelOptions = _ref.labelOptions,\n      labelNeedBaselineAlign = _ref.labelNeedBaselineAlign,\n      labelLocation = _ref.labelLocation,\n      needRenderLabel = _ref.needRenderLabel,\n      formLabelLocation = _ref.formLabelLocation,\n      item = _ref.item,\n      editorOptions = _ref.editorOptions,\n      isSimpleItem = _ref.isSimpleItem,\n      isRequired = _ref.isRequired,\n      template = _ref.template,\n      helpID = _ref.helpID,\n      labelID = _ref.labelID,\n      name = _ref.name,\n      helpText = _ref.helpText,\n      requiredMessageTemplate = _ref.requiredMessageTemplate,\n      validationGroup = _ref.validationGroup;\n  var $rootElement = $(\"<div>\").addClass(rootElementCssClassList.join(\" \")).appendTo($parent);\n  $rootElement.addClass(isRequired ? FIELD_ITEM_REQUIRED_CLASS : FIELD_ITEM_OPTIONAL_CLASS);\n\n  if (isSimpleItem && useFlexLayout) {\n    $rootElement.addClass(FLEX_LAYOUT_CLASS);\n  }\n\n  if (isSimpleItem && labelNeedBaselineAlign) {\n    $rootElement.addClass(FIELD_ITEM_LABEL_ALIGN_CLASS);\n  }\n\n  var $fieldEditorContainer = $(\"<div>\");\n  $fieldEditorContainer.data(\"dx-form-item\", item);\n  $fieldEditorContainer.addClass(FIELD_ITEM_CONTENT_CLASS).addClass(FIELD_ITEM_CONTENT_LOCATION_CLASS + {\n    right: \"left\",\n    left: \"right\",\n    top: \"bottom\"\n  }[formLabelLocation]);\n  var $label = needRenderLabel ? renderLabel(labelOptions) : null;\n\n  if ($label) {\n    $rootElement.append($label);\n\n    if (\"top\" === labelLocation || \"left\" === labelLocation) {\n      $rootElement.append($fieldEditorContainer);\n    }\n\n    if (\"right\" === labelLocation) {\n      $rootElement.prepend($fieldEditorContainer);\n    }\n\n    if (\"top\" === labelLocation) {\n      $rootElement.addClass(LABEL_VERTICAL_ALIGNMENT_CLASS);\n    } else {\n      $rootElement.addClass(LABEL_HORIZONTAL_ALIGNMENT_CLASS);\n    }\n\n    if (\"dxCheckBox\" === item.editorType || \"dxSwitch\" === item.editorType) {\n      eventsEngine.on($label, clickEventName, function () {\n        eventsEngine.trigger($fieldEditorContainer.children(), clickEventName);\n      });\n    }\n  } else {\n    $rootElement.append($fieldEditorContainer);\n  }\n\n  var widgetInstance;\n\n  if (template) {\n    template.render({\n      container: getPublicElement($fieldEditorContainer),\n      model: {\n        dataField: item.dataField,\n        editorType: item.editorType,\n        editorOptions: editorOptions,\n        component: formOrLayoutManager,\n        name: item.name\n      }\n    });\n  } else {\n    var $div = $(\"<div>\").appendTo($fieldEditorContainer);\n\n    try {\n      widgetInstance = createComponentCallback($div, item.editorType, editorOptions);\n      widgetInstance.setAria(\"describedby\", helpID);\n\n      if (labelID) {\n        widgetInstance.setAria(\"labelledby\", labelID);\n      }\n\n      widgetInstance.setAria(\"required\", isRequired);\n    } catch (e) {\n      errors.log(\"E1035\", e.message);\n    }\n  }\n\n  var editorElem = $fieldEditorContainer.children().first();\n  var $validationTarget = editorElem.hasClass(TEMPLATE_WRAPPER_CLASS) ? editorElem.children().first() : editorElem;\n  var validationTargetInstance = $validationTarget && $validationTarget.data(\"dx-validation-target\");\n\n  if (validationTargetInstance) {\n    var isItemHaveCustomLabel = item.label && item.label.text;\n    var itemName = isItemHaveCustomLabel ? null : name;\n    var fieldName = isItemHaveCustomLabel ? item.label.text : itemName && captionize(itemName);\n    var validationRules;\n\n    if (isSimpleItem) {\n      if (item.validationRules) {\n        validationRules = item.validationRules;\n      } else {\n        var requiredMessage = format(requiredMessageTemplate, fieldName || \"\");\n        validationRules = item.isRequired ? [{\n          type: \"required\",\n          message: requiredMessage\n        }] : null;\n      }\n    }\n\n    if (Array.isArray(validationRules) && validationRules.length) {\n      createComponentCallback($validationTarget, Validator, {\n        validationRules: validationRules,\n        validationGroup: validationGroup,\n        dataGetter: function dataGetter() {\n          return {\n            formItem: item\n          };\n        }\n      });\n    }\n\n    if (isMaterial()) {\n      var wrapperClass = \".\" + FIELD_ITEM_CONTENT_WRAPPER_CLASS;\n\n      var toggleInvalidClass = function toggleInvalidClass(e) {\n        $(e.element).parents(wrapperClass).toggleClass(INVALID_CLASS, false === e.component.option(\"isValid\") && (e.component._isFocused() || \"always\" === e.component.option(\"validationMessageMode\")));\n      };\n\n      validationTargetInstance.on(\"optionChanged\", function (e) {\n        if (\"isValid\" !== e.name) {\n          return;\n        }\n\n        toggleInvalidClass(e);\n      });\n      validationTargetInstance.on(\"focusIn\", toggleInvalidClass).on(\"focusOut\", toggleInvalidClass).on(\"enterKey\", toggleInvalidClass);\n    }\n  }\n\n  if (helpText && isSimpleItem) {\n    var $editorParent = $fieldEditorContainer.parent();\n    $editorParent.append($(\"<div>\").addClass(FIELD_ITEM_CONTENT_WRAPPER_CLASS).append($fieldEditorContainer).append($(\"<div>\").addClass(FIELD_ITEM_HELP_TEXT_CLASS).attr(\"id\", helpID).text(helpText)));\n  }\n\n  return {\n    $fieldEditorContainer: $fieldEditorContainer,\n    $rootElement: $rootElement,\n    widgetInstance: widgetInstance\n  };\n}","map":null,"metadata":{},"sourceType":"module"}