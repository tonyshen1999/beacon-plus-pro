{"ast":null,"code":"/**\r\n * DevExtreme (esm/renovation/ui/scheduler/view_model/to_test/views/utils/base.js)\r\n * Version: 21.2.6\r\n * Build date: Tue Mar 01 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport errors from \"../../../../../../../ui/widget/ui.errors\";\nimport dateUtils from \"../../../../../../../core/utils/date\";\nimport { isDefined } from \"../../../../../../../core/utils/type\";\nimport dateLocalization from \"../../../../../../../localization/date\";\nimport timeZoneUtils from \"../../../../../../../ui/scheduler/utils.timeZone\";\nimport { VERTICAL_GROUP_COUNT_CLASSES } from \"../../../../../../../ui/scheduler/classes\";\nimport { VIEWS } from \"../../../../../../../ui/scheduler/constants\";\nimport { getGroupCount } from \"../../../../../../../ui/scheduler/resources/utils\";\nimport { isVerticalGroupingApplied } from \"../../../../workspaces/utils\";\nexport var isDateInRange = function isDateInRange(date, startDate, endDate, diff) {\n  return diff > 0 ? dateUtils.dateInRange(date, startDate, new Date(endDate.getTime() - 1)) : dateUtils.dateInRange(date, endDate, startDate, \"date\");\n};\nexport var setOptionHour = function setOptionHour(date, optionHour) {\n  var nextDate = new Date(date);\n\n  if (!isDefined(optionHour)) {\n    return nextDate;\n  }\n\n  nextDate.setHours(optionHour, optionHour % 1 * 60, 0, 0);\n  return nextDate;\n};\nexport var getViewStartByOptions = function getViewStartByOptions(startDate, currentDate, intervalDuration, startViewDate) {\n  if (!startDate) {\n    return new Date(currentDate);\n  }\n\n  var currentStartDate = dateUtils.trimTime(startViewDate);\n  var diff = currentStartDate.getTime() <= currentDate.getTime() ? 1 : -1;\n  var endDate = new Date(currentStartDate.getTime() + intervalDuration * diff);\n\n  while (!isDateInRange(currentDate, currentStartDate, endDate, diff)) {\n    currentStartDate = endDate;\n    endDate = new Date(currentStartDate.getTime() + intervalDuration * diff);\n  }\n\n  return diff > 0 ? currentStartDate : endDate;\n};\nexport var getCalculatedFirstDayOfWeek = function getCalculatedFirstDayOfWeek(firstDayOfWeekOption) {\n  return isDefined(firstDayOfWeekOption) ? firstDayOfWeekOption : dateLocalization.firstDayOfWeekIndex();\n};\nexport var calculateViewStartDate = function calculateViewStartDate(startDateOption) {\n  return startDateOption;\n};\nexport var calculateCellIndex = function calculateCellIndex(rowIndex, columnIndex, rowCount) {\n  return columnIndex * rowCount + rowIndex;\n};\nexport var getStartViewDateWithoutDST = function getStartViewDateWithoutDST(startViewDate, startDayHour) {\n  var newStartViewDate = timeZoneUtils.getDateWithoutTimezoneChange(startViewDate);\n  newStartViewDate.setHours(startDayHour);\n  return newStartViewDate;\n};\nexport var getHeaderCellText = function getHeaderCellText(headerIndex, date, headerCellTextFormat, getDateForHeaderText, additionalOptions) {\n  var validDate = getDateForHeaderText(headerIndex, date, additionalOptions);\n  return dateLocalization.format(validDate, headerCellTextFormat);\n};\nexport var validateDayHours = function validateDayHours(startDayHour, endDayHour) {\n  if (startDayHour >= endDayHour) {\n    throw errors.Error(\"E1058\");\n  }\n};\nexport var getStartViewDateTimeOffset = function getStartViewDateTimeOffset(startViewDate, startDayHour) {\n  var validStartDayHour = Math.floor(startDayHour);\n  var isDSTChange = timeZoneUtils.isTimezoneChangeInDate(startViewDate);\n\n  if (isDSTChange && validStartDayHour !== startViewDate.getHours()) {\n    return dateUtils.dateToMilliseconds(\"hour\");\n  }\n\n  return 0;\n};\nexport var formatWeekday = function formatWeekday(date) {\n  return dateLocalization.getDayNames(\"abbreviated\")[date.getDay()];\n};\nexport var formatWeekdayAndDay = function formatWeekdayAndDay(date) {\n  return \"\".concat(formatWeekday(date), \" \").concat(dateLocalization.format(date, \"day\"));\n};\nexport var getToday = function getToday(indicatorTime, timeZoneCalculator) {\n  var todayDate = null !== indicatorTime && void 0 !== indicatorTime ? indicatorTime : new Date();\n  return (null === timeZoneCalculator || void 0 === timeZoneCalculator ? void 0 : timeZoneCalculator.createDate(todayDate, {\n    path: \"toGrid\"\n  })) || todayDate;\n};\nexport var getVerticalGroupCountClass = function getVerticalGroupCountClass(groups) {\n  switch (null === groups || void 0 === groups ? void 0 : groups.length) {\n    case 1:\n      return VERTICAL_GROUP_COUNT_CLASSES[0];\n\n    case 2:\n      return VERTICAL_GROUP_COUNT_CLASSES[1];\n\n    case 3:\n      return VERTICAL_GROUP_COUNT_CLASSES[2];\n\n    default:\n      return;\n  }\n};\nexport var isDateAndTimeView = function isDateAndTimeView(viewType) {\n  return viewType !== VIEWS.TIMELINE_MONTH && viewType !== VIEWS.MONTH;\n};\nexport var isSupportMultiDayAppointments = function isSupportMultiDayAppointments(viewType) {\n  return [VIEWS.TIMELINE_DAY, VIEWS.TIMELINE_WEEK, VIEWS.TIMELINE_WORK_WEEK, VIEWS.TIMELINE_MONTH].includes(viewType);\n};\nexport var getHorizontalGroupCount = function getHorizontalGroupCount(groups, groupOrientation) {\n  var groupCount = getGroupCount(groups) || 1;\n  var isVerticalGrouping = isVerticalGroupingApplied(groups, groupOrientation);\n  return isVerticalGrouping ? 1 : groupCount;\n};\nexport var calculateIsGroupedAllDayPanel = function calculateIsGroupedAllDayPanel(groups, groupOrientation, isAllDayPanelVisible) {\n  return isVerticalGroupingApplied(groups, groupOrientation) && isAllDayPanelVisible;\n};\nexport var calculateDayDuration = function calculateDayDuration(startDayHour, endDayHour) {\n  return endDayHour - startDayHour;\n};\nexport var isHorizontalView = function isHorizontalView(viewType) {\n  switch (viewType) {\n    case VIEWS.TIMELINE_DAY:\n    case VIEWS.TIMELINE_WEEK:\n    case VIEWS.TIMELINE_WORK_WEEK:\n    case VIEWS.TIMELINE_MONTH:\n    case VIEWS.MONTH:\n      return true;\n\n    default:\n      return false;\n  }\n};\nexport var getTotalCellCountByCompleteData = function getTotalCellCountByCompleteData(completeData) {\n  return completeData[completeData.length - 1].length;\n};\nexport var getTotalRowCountByCompleteData = function getTotalRowCountByCompleteData(completeData) {\n  return completeData.length;\n};\nexport var getDisplayedCellCount = function getDisplayedCellCount(displayedCellCount, completeData) {\n  return null !== displayedCellCount && void 0 !== displayedCellCount ? displayedCellCount : getTotalCellCountByCompleteData(completeData);\n};\nexport var getDisplayedRowCount = function getDisplayedRowCount(displayedRowCount, completeData) {\n  return null !== displayedRowCount && void 0 !== displayedRowCount ? displayedRowCount : getTotalRowCountByCompleteData(completeData);\n};\nexport var getCellDuration = function getCellDuration(viewType, startDayHour, endDayHour, hoursInterval) {\n  switch (viewType) {\n    case \"month\":\n      return 36e5 * calculateDayDuration(startDayHour, endDayHour);\n\n    case \"timelineMonth\":\n      return dateUtils.dateToMilliseconds(\"day\");\n\n    default:\n      return 36e5 * hoursInterval;\n  }\n};","map":null,"metadata":{},"sourceType":"module"}