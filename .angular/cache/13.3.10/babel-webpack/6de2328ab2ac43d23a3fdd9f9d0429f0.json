{"ast":null,"code":"/**\r\n * DevExtreme (esm/events/core/keyboard_processor.js)\r\n * Version: 21.2.6\r\n * Build date: Tue Mar 01 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../../core/renderer\";\nimport eventsEngine from \"../../events/core/events_engine\";\nimport Class from \"../../core/class\";\nimport { inArray } from \"../../core/utils/array\";\nimport { addNamespace, normalizeKeyName } from \"../../events/utils/index\";\nvar COMPOSITION_START_EVENT = \"compositionstart\";\nvar COMPOSITION_END_EVENT = \"compositionend\";\nvar KEYDOWN_EVENT = \"keydown\";\nvar NAMESPACE = \"KeyboardProcessor\";\n\nvar createKeyDownOptions = function createKeyDownOptions(e) {\n  return {\n    keyName: normalizeKeyName(e),\n    key: e.key,\n    code: e.code,\n    ctrl: e.ctrlKey,\n    location: e.location,\n    metaKey: e.metaKey,\n    shift: e.shiftKey,\n    alt: e.altKey,\n    which: e.which,\n    originalEvent: e\n  };\n};\n\nvar KeyboardProcessor = Class.inherit({\n  _keydown: addNamespace(KEYDOWN_EVENT, NAMESPACE),\n  _compositionStart: addNamespace(COMPOSITION_START_EVENT, NAMESPACE),\n  _compositionEnd: addNamespace(COMPOSITION_END_EVENT, NAMESPACE),\n  ctor: function ctor(options) {\n    var _this = this;\n\n    options = options || {};\n\n    if (options.element) {\n      this._element = $(options.element);\n    }\n\n    if (options.focusTarget) {\n      this._focusTarget = options.focusTarget;\n    }\n\n    this._handler = options.handler;\n\n    if (this._element) {\n      this._processFunction = function (e) {\n        var isNotFocusTarget = _this._focusTarget && _this._focusTarget !== e.target && inArray(e.target, $(_this._focusTarget)) < 0;\n        var shouldSkipProcessing = _this._isComposingJustFinished && 229 === e.which || _this._isComposing || isNotFocusTarget;\n        _this._isComposingJustFinished = false;\n\n        if (!shouldSkipProcessing) {\n          _this.process(e);\n        }\n      };\n\n      this._toggleProcessingWithContext = this.toggleProcessing.bind(this);\n      eventsEngine.on(this._element, this._keydown, this._processFunction);\n      eventsEngine.on(this._element, this._compositionStart, this._toggleProcessingWithContext);\n      eventsEngine.on(this._element, this._compositionEnd, this._toggleProcessingWithContext);\n    }\n  },\n  dispose: function dispose() {\n    if (this._element) {\n      eventsEngine.off(this._element, this._keydown, this._processFunction);\n      eventsEngine.off(this._element, this._compositionStart, this._toggleProcessingWithContext);\n      eventsEngine.off(this._element, this._compositionEnd, this._toggleProcessingWithContext);\n    }\n\n    this._element = void 0;\n    this._handler = void 0;\n  },\n  process: function process(e) {\n    this._handler(createKeyDownOptions(e));\n  },\n  toggleProcessing: function toggleProcessing(_ref) {\n    var type = _ref.type;\n    this._isComposing = type === COMPOSITION_START_EVENT;\n    this._isComposingJustFinished = !this._isComposing;\n  }\n});\nKeyboardProcessor.createKeyDownOptions = createKeyDownOptions;\nexport default KeyboardProcessor;","map":null,"metadata":{},"sourceType":"module"}