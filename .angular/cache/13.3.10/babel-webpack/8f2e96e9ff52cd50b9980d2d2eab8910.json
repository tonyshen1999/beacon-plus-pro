{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/form/ui.form.layout_manager.utils.js)\r\n * Version: 21.2.6\r\n * Build date: Tue Mar 01 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { extend } from \"../../core/utils/extend\";\nimport { isDefined } from \"../../core/utils/type\";\nimport { each } from \"../../core/utils/iterator\";\nimport { captionize } from \"../../core/utils/inflector\";\nimport { inArray } from \"../../core/utils/array\";\nimport Guid from \"../../core/guid\";\nimport { SIMPLE_ITEM_TYPE } from \"./constants\";\nvar EDITORS_WITH_ARRAY_VALUE = [\"dxTagBox\", \"dxRangeSlider\"];\nexport var EDITORS_WITHOUT_LABELS = [\"dxCalendar\", \"dxCheckBox\", \"dxHtmlEditor\", \"dxRadioGroup\", \"dxRangeSlider\", \"dxSlider\", \"dxSwitch\"];\nexport function convertToRenderFieldItemOptions(_ref) {\n  var $parent = _ref.$parent,\n      rootElementCssClassList = _ref.rootElementCssClassList,\n      formOrLayoutManager = _ref.formOrLayoutManager,\n      createComponentCallback = _ref.createComponentCallback,\n      useFlexLayout = _ref.useFlexLayout,\n      item = _ref.item,\n      template = _ref.template,\n      name = _ref.name,\n      formLabelLocation = _ref.formLabelLocation,\n      requiredMessageTemplate = _ref.requiredMessageTemplate,\n      validationGroup = _ref.validationGroup,\n      editorValue = _ref.editorValue,\n      canAssignUndefinedValueToEditor = _ref.canAssignUndefinedValueToEditor,\n      editorValidationBoundary = _ref.editorValidationBoundary,\n      editorStylingMode = _ref.editorStylingMode,\n      showColonAfterLabel = _ref.showColonAfterLabel,\n      managerLabelLocation = _ref.managerLabelLocation,\n      itemId = _ref.itemId,\n      managerMarkOptions = _ref.managerMarkOptions,\n      labelMode = _ref.labelMode;\n  var isRequired = isDefined(item.isRequired) ? item.isRequired : !!_hasRequiredRuleInSet(item.validationRules);\n  var isSimpleItem = item.itemType === SIMPLE_ITEM_TYPE;\n  var helpID = item.helpText ? \"dx-\" + new Guid() : null;\n\n  var labelOptions = _convertToLabelOptions({\n    item: item,\n    id: itemId,\n    isRequired: isRequired,\n    managerMarkOptions: managerMarkOptions,\n    showColonAfterLabel: showColonAfterLabel,\n    labelLocation: managerLabelLocation,\n    formLabelMode: labelMode\n  });\n\n  var needRenderLabel = labelOptions.visible && labelOptions.text;\n  var labelLocation = labelOptions.location,\n      labelID = labelOptions.labelID;\n  var labelNeedBaselineAlign = \"top\" !== labelLocation && (!!item.helpText && !useFlexLayout || -1 !== inArray(item.editorType, [\"dxTextArea\", \"dxRadioGroup\", \"dxCalendar\", \"dxHtmlEditor\"]));\n\n  var editorOptions = _convertToEditorOptions({\n    editorType: item.editorType,\n    editorValue: editorValue,\n    defaultEditorName: item.dataField,\n    canAssignUndefinedValueToEditor: canAssignUndefinedValueToEditor,\n    externalEditorOptions: item.editorOptions,\n    editorInputId: itemId,\n    editorValidationBoundary: editorValidationBoundary,\n    editorStylingMode: editorStylingMode,\n    formLabelMode: labelMode,\n    labelText: labelOptions.textWithoutColon,\n    labelMark: labelOptions.markOptions.showRequiredMark ? String.fromCharCode(160) + labelOptions.markOptions.requiredMark : \"\"\n  });\n\n  var needRenderOptionalMarkAsHelpText = labelOptions.markOptions.showOptionalMark && !labelOptions.visible && \"hidden\" !== editorOptions.labelMode && !isDefined(item.helpText);\n  var helpText = needRenderOptionalMarkAsHelpText ? labelOptions.markOptions.optionalMark : item.helpText;\n  return {\n    $parent: $parent,\n    rootElementCssClassList: rootElementCssClassList,\n    formOrLayoutManager: formOrLayoutManager,\n    createComponentCallback: createComponentCallback,\n    useFlexLayout: useFlexLayout,\n    labelOptions: labelOptions,\n    labelNeedBaselineAlign: labelNeedBaselineAlign,\n    labelLocation: labelLocation,\n    needRenderLabel: needRenderLabel,\n    item: item,\n    isSimpleItem: isSimpleItem,\n    isRequired: isRequired,\n    template: template,\n    helpID: helpID,\n    labelID: labelID,\n    name: name,\n    helpText: helpText,\n    formLabelLocation: formLabelLocation,\n    requiredMessageTemplate: requiredMessageTemplate,\n    validationGroup: validationGroup,\n    editorOptions: editorOptions\n  };\n}\nexport function getLabelMarkText(_ref2) {\n  var showRequiredMark = _ref2.showRequiredMark,\n      requiredMark = _ref2.requiredMark,\n      showOptionalMark = _ref2.showOptionalMark,\n      optionalMark = _ref2.optionalMark;\n\n  if (!showRequiredMark && !showOptionalMark) {\n    return \"\";\n  }\n\n  return String.fromCharCode(160) + (showRequiredMark ? requiredMark : optionalMark);\n}\nexport function convertToLabelMarkOptions(_ref3, isRequired) {\n  var showRequiredMark = _ref3.showRequiredMark,\n      requiredMark = _ref3.requiredMark,\n      showOptionalMark = _ref3.showOptionalMark,\n      optionalMark = _ref3.optionalMark;\n  return {\n    showRequiredMark: showRequiredMark && isRequired,\n    requiredMark: requiredMark,\n    showOptionalMark: showOptionalMark && !isRequired,\n    optionalMark: optionalMark\n  };\n}\n\nfunction _convertToEditorOptions(_ref4) {\n  var editorType = _ref4.editorType,\n      defaultEditorName = _ref4.defaultEditorName,\n      editorValue = _ref4.editorValue,\n      canAssignUndefinedValueToEditor = _ref4.canAssignUndefinedValueToEditor,\n      externalEditorOptions = _ref4.externalEditorOptions,\n      editorInputId = _ref4.editorInputId,\n      editorValidationBoundary = _ref4.editorValidationBoundary,\n      editorStylingMode = _ref4.editorStylingMode,\n      formLabelMode = _ref4.formLabelMode,\n      labelText = _ref4.labelText,\n      labelMark = _ref4.labelMark;\n  var editorOptionsWithValue = {};\n\n  if (void 0 !== editorValue || canAssignUndefinedValueToEditor) {\n    editorOptionsWithValue.value = editorValue;\n  }\n\n  if (-1 !== EDITORS_WITH_ARRAY_VALUE.indexOf(editorType)) {\n    editorOptionsWithValue.value = editorOptionsWithValue.value || [];\n  }\n\n  var labelMode = null === externalEditorOptions || void 0 === externalEditorOptions ? void 0 : externalEditorOptions.labelMode;\n\n  if (!isDefined(labelMode)) {\n    labelMode = \"outside\" === formLabelMode ? \"hidden\" : formLabelMode;\n  }\n\n  var stylingMode = (null === externalEditorOptions || void 0 === externalEditorOptions ? void 0 : externalEditorOptions.stylingMode) || editorStylingMode;\n  var result = extend(true, editorOptionsWithValue, externalEditorOptions, {\n    inputAttr: {\n      id: editorInputId\n    },\n    validationBoundary: editorValidationBoundary,\n    stylingMode: stylingMode,\n    label: labelText,\n    labelMode: labelMode,\n    labelMark: labelMark\n  });\n\n  if (externalEditorOptions) {\n    if (result.dataSource) {\n      result.dataSource = externalEditorOptions.dataSource;\n    }\n\n    if (result.items) {\n      result.items = externalEditorOptions.items;\n    }\n  }\n\n  if (defaultEditorName && !result.name) {\n    result.name = defaultEditorName;\n  }\n\n  return result;\n}\n\nfunction _hasRequiredRuleInSet(rules) {\n  var hasRequiredRule;\n\n  if (rules && rules.length) {\n    each(rules, function (index, rule) {\n      if (\"required\" === rule.type) {\n        hasRequiredRule = true;\n        return false;\n      }\n    });\n  }\n\n  return hasRequiredRule;\n}\n\nfunction _convertToLabelOptions(_ref5) {\n  var item = _ref5.item,\n      id = _ref5.id,\n      isRequired = _ref5.isRequired,\n      managerMarkOptions = _ref5.managerMarkOptions,\n      showColonAfterLabel = _ref5.showColonAfterLabel,\n      labelLocation = _ref5.labelLocation,\n      formLabelMode = _ref5.formLabelMode;\n  var isEditorWithoutLabels = -1 !== inArray(item.editorType, EDITORS_WITHOUT_LABELS);\n  var labelOptions = extend({\n    showColon: showColonAfterLabel,\n    location: labelLocation,\n    id: id,\n    visible: \"outside\" === formLabelMode || isEditorWithoutLabels && \"hidden\" !== formLabelMode,\n    isRequired: isRequired\n  }, item ? item.label : {}, {\n    markOptions: convertToLabelMarkOptions(managerMarkOptions, isRequired)\n  });\n\n  if (-1 !== inArray(item.editorType, [\"dxRadioGroup\", \"dxCheckBox\", \"dxLookup\", \"dxSlider\", \"dxRangeSlider\", \"dxSwitch\", \"dxHtmlEditor\"])) {\n    labelOptions.labelID = \"dx-label-\".concat(new Guid());\n  }\n\n  if (!labelOptions.text && item.dataField) {\n    labelOptions.text = captionize(item.dataField);\n  }\n\n  if (labelOptions.text) {\n    labelOptions.textWithoutColon = labelOptions.text;\n    labelOptions.text += labelOptions.showColon ? \":\" : \"\";\n  }\n\n  return labelOptions;\n}","map":null,"metadata":{},"sourceType":"module"}