{"ast":null,"code":"/**\r\n * DevExtreme (esm/exporter/excel_format_converter.js)\r\n * Version: 21.2.6\r\n * Build date: Tue Mar 01 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { format as stringFormat } from \"../core/utils/string\";\nimport numberFormatter from \"../localization/number\";\nimport dateLocalization from \"../localization/date\";\nimport { isDefined, isString } from \"../core/utils/type\";\nimport { getFormat } from \"../localization/ldml/date.format\";\nimport { getLanguageId } from \"../localization/language_codes\";\nimport \"../localization/currency\";\nvar ARABIC_ZERO_CODE = 1632;\nvar DEFINED_NUMBER_FORMTATS = {\n  thousands: \"#,##0{0},&quot;K&quot;\",\n  millions: \"#,##0{0},,&quot;M&quot;\",\n  billions: \"#,##0{0},,,&quot;B&quot;\",\n  trillions: \"#,##0{0},,,,&quot;T&quot;\",\n  percent: \"0{0}%\",\n  decimal: \"#{0}\",\n  fixedpoint: \"#,##0{0}\",\n  exponential: \"0{0}E+00\",\n  currency: \" \"\n};\nvar PERIOD_REGEXP = /a+/g;\nvar DAY_REGEXP = /E/g;\nvar DO_REGEXP = /dE+/g;\nvar STANDALONE_MONTH_REGEXP = /L/g;\nvar HOUR_REGEXP = /h/g;\nvar ANY_REGEXP = /./g;\nvar excelFormatConverter = {\n  _applyPrecision: function _applyPrecision(format, precision) {\n    var result;\n    var i;\n\n    if (precision > 0) {\n      result = \"decimal\" !== format ? \".\" : \"\";\n\n      for (i = 0; i < precision; i++) {\n        result += \"0\";\n      }\n\n      return result;\n    }\n\n    return \"\";\n  },\n  _hasArabicDigits: function _hasArabicDigits(text) {\n    var code;\n\n    for (var i = 0; i < text.length; i++) {\n      code = text.charCodeAt(i);\n\n      if (code >= ARABIC_ZERO_CODE && code < ARABIC_ZERO_CODE + 10) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n  _convertDateFormatToOpenXml: function _convertDateFormatToOpenXml(format) {\n    return format.split(\"/\").join(\"\\\\/\").split(\"'\").map(function (datePart, index) {\n      if (index % 2 === 0) {\n        return datePart.replace(PERIOD_REGEXP, \"AM/PM\").replace(DO_REGEXP, \"d\").replace(DAY_REGEXP, \"d\").replace(STANDALONE_MONTH_REGEXP, \"M\").replace(HOUR_REGEXP, \"H\").split(\"[\").join(\"\\\\[\").split(\"]\").join(\"\\\\]\");\n      }\n\n      if (datePart) {\n        return datePart.replace(ANY_REGEXP, \"\\\\$&\");\n      }\n\n      return \"'\";\n    }).join(\"\");\n  },\n  _convertDateFormat: function _convertDateFormat(format) {\n    var formattedValue = (dateLocalization.format(new Date(2009, 8, 8, 6, 5, 4), format) || \"\").toString();\n    var result = getFormat(function (value) {\n      return dateLocalization.format(value, format);\n    });\n\n    if (result) {\n      result = this._convertDateFormatToOpenXml(result);\n      result = this._getLanguageInfo(formattedValue) + result;\n    }\n\n    return result;\n  },\n  _getLanguageInfo: function _getLanguageInfo(defaultPattern) {\n    var languageID = getLanguageId();\n    var languageIDStr = languageID ? languageID.toString(16) : \"\";\n    var languageInfo = \"\";\n\n    if (this._hasArabicDigits(defaultPattern)) {\n      while (languageIDStr.length < 3) {\n        languageIDStr = \"0\" + languageIDStr;\n      }\n\n      languageInfo = \"[$-2010\" + languageIDStr + \"]\";\n    } else if (languageIDStr) {\n      languageInfo = \"[$-\" + languageIDStr + \"]\";\n    }\n\n    return languageInfo;\n  },\n  _convertNumberFormat: function _convertNumberFormat(format, precision, currency) {\n    var result;\n    var excelFormat;\n\n    if (\"currency\" === format) {\n      excelFormat = numberFormatter.getOpenXmlCurrencyFormat(currency);\n    } else {\n      excelFormat = DEFINED_NUMBER_FORMTATS[format.toLowerCase()];\n    }\n\n    if (excelFormat) {\n      result = stringFormat(excelFormat, this._applyPrecision(format, precision));\n    }\n\n    return result;\n  },\n  convertFormat: function convertFormat(format, precision, type, currency) {\n    if (isDefined(format)) {\n      if (\"date\" === type) {\n        return excelFormatConverter._convertDateFormat(format);\n      } else if (isString(format) && DEFINED_NUMBER_FORMTATS[format.toLowerCase()]) {\n        return excelFormatConverter._convertNumberFormat(format, precision, currency);\n      }\n    }\n  }\n};\nexport default excelFormatConverter;","map":null,"metadata":{},"sourceType":"module"}