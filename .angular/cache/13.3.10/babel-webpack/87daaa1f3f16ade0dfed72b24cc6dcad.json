{"ast":null,"code":"/**\r\n * DevExtreme (esm/viz/funnel/tracker.js)\r\n * Version: 21.2.6\r\n * Build date: Tue Mar 01 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport Funnel from \"./funnel\";\nimport { Tracker } from \"../components/tracker\";\nvar DATA_KEY_BASE = \"__funnel_data_\";\nimport { isDefined } from \"../../core/utils/type\";\nvar dataKeyModifier = 0;\nvar proto = Funnel.prototype;\nproto._eventsMap.onItemClick = {\n  name: \"itemClick\"\n};\nproto._eventsMap.onLegendClick = {\n  name: \"legendClick\"\n};\n\nvar getDataKey = function getDataKey() {\n  return DATA_KEY_BASE + dataKeyModifier++;\n};\n\nexport var plugin = {\n  name: \"tracker\",\n  init: function init() {\n    var that = this;\n    var dataKey = getDataKey();\n\n    var getProxyData = function getProxyData(e) {\n      var rootOffset = that._renderer.getRootOffset();\n\n      var x = Math.floor(e.pageX - rootOffset.left);\n      var y = Math.floor(e.pageY - rootOffset.top);\n      return that._hitTestTargets(x, y);\n    };\n\n    that._tracker = new Tracker({\n      widget: that,\n      root: that._renderer.root,\n      getData: function getData(e, tooltipData) {\n        var target = e.target;\n        var data = target[dataKey];\n\n        if (isDefined(data)) {\n          return data;\n        }\n\n        var proxyData = getProxyData(e);\n\n        if (tooltipData && proxyData && \"inside-label\" !== proxyData.type) {\n          return;\n        }\n\n        return proxyData && proxyData.id;\n      },\n      getNode: function getNode(index) {\n        return that._items[index];\n      },\n      click: function click(e) {\n        var proxyData = getProxyData(e.event);\n        var dataType = proxyData && proxyData.type;\n        var event = \"legend\" === dataType ? \"legendClick\" : \"itemClick\";\n\n        that._eventTrigger(event, {\n          item: e.node,\n          event: e.event\n        });\n      }\n    });\n    this._dataKey = dataKey;\n  },\n  dispose: function dispose() {\n    this._tracker.dispose();\n  },\n  extenders: {\n    _change_TILING: function _change_TILING() {\n      var dataKey = this._dataKey;\n\n      this._items.forEach(function (item, index) {\n        item.element.data(dataKey, index);\n      });\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module"}