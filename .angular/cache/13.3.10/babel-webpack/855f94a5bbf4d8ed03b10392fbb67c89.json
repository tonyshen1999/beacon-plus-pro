{"ast":null,"code":"import _slicedToArray from \"/Users/tonyshen/beacon-pro/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\n/**\r\n * DevExtreme (esm/localization/number.js)\r\n * Version: 21.2.6\r\n * Build date: Tue Mar 01 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport dependencyInjector from \"../core/utils/dependency_injector\";\nimport { inArray, find } from \"../core/utils/array\";\nimport { escapeRegExp } from \"../core/utils/common\";\nimport { each } from \"../core/utils/iterator\";\nimport { isPlainObject } from \"../core/utils/type\";\nimport { getFormatter } from \"./ldml/number\";\nimport config from \"../core/config\";\nimport errors from \"../core/errors\";\nimport { toFixed } from \"./utils\";\nimport currencyLocalization from \"./currency\";\nimport intlNumberLocalization from \"./intl/number\";\nvar hasIntl = \"undefined\" !== typeof Intl;\nvar MAX_LARGE_NUMBER_POWER = 4;\nvar DECIMAL_BASE = 10;\nvar NUMERIC_FORMATS = [\"currency\", \"fixedpoint\", \"exponential\", \"percent\", \"decimal\"];\nvar LargeNumberFormatPostfixes = {\n  1: \"K\",\n  2: \"M\",\n  3: \"B\",\n  4: \"T\"\n};\nvar LargeNumberFormatPowers = {\n  largenumber: \"auto\",\n  thousands: 1,\n  millions: 2,\n  billions: 3,\n  trillions: 4\n};\nvar numberLocalization = dependencyInjector({\n  engine: function engine() {\n    return \"base\";\n  },\n  numericFormats: NUMERIC_FORMATS,\n  defaultLargeNumberFormatPostfixes: LargeNumberFormatPostfixes,\n  _parseNumberFormatString: function _parseNumberFormatString(formatType) {\n    var formatObject = {};\n\n    if (!formatType || \"string\" !== typeof formatType) {\n      return;\n    }\n\n    var formatList = formatType.toLowerCase().split(\" \");\n    each(formatList, function (index, value) {\n      if (inArray(value, NUMERIC_FORMATS) > -1) {\n        formatObject.formatType = value;\n      } else if (value in LargeNumberFormatPowers) {\n        formatObject.power = LargeNumberFormatPowers[value];\n      }\n    });\n\n    if (formatObject.power && !formatObject.formatType) {\n      formatObject.formatType = \"fixedpoint\";\n    }\n\n    if (formatObject.formatType) {\n      return formatObject;\n    }\n  },\n  _calculateNumberPower: function _calculateNumberPower(value, base, minPower, maxPower) {\n    var number = Math.abs(value);\n    var power = 0;\n\n    if (number > 1) {\n      while (number && number >= base && (void 0 === maxPower || power < maxPower)) {\n        power++;\n        number /= base;\n      }\n    } else if (number > 0 && number < 1) {\n      while (number < 1 && (void 0 === minPower || power > minPower)) {\n        power--;\n        number *= base;\n      }\n    }\n\n    return power;\n  },\n  _getNumberByPower: function _getNumberByPower(number, power, base) {\n    var result = number;\n\n    while (power > 0) {\n      result /= base;\n      power--;\n    }\n\n    while (power < 0) {\n      result *= base;\n      power++;\n    }\n\n    return result;\n  },\n  _formatNumber: function _formatNumber(value, formatObject, formatConfig) {\n    if (\"auto\" === formatObject.power) {\n      formatObject.power = this._calculateNumberPower(value, 1e3, 0, MAX_LARGE_NUMBER_POWER);\n    }\n\n    if (formatObject.power) {\n      value = this._getNumberByPower(value, formatObject.power, 1e3);\n    }\n\n    var powerPostfix = this.defaultLargeNumberFormatPostfixes[formatObject.power] || \"\";\n\n    var result = this._formatNumberCore(value, formatObject.formatType, formatConfig);\n\n    result = result.replace(/(\\d|.$)(\\D*)$/, \"$1\" + powerPostfix + \"$2\");\n    return result;\n  },\n  _formatNumberExponential: function _formatNumberExponential(value, formatConfig) {\n    var power = this._calculateNumberPower(value, DECIMAL_BASE);\n\n    var number = this._getNumberByPower(value, power, DECIMAL_BASE);\n\n    if (void 0 === formatConfig.precision) {\n      formatConfig.precision = 1;\n    }\n\n    if (number.toFixed(formatConfig.precision || 0) >= DECIMAL_BASE) {\n      power++;\n      number /= DECIMAL_BASE;\n    }\n\n    var powString = (power >= 0 ? \"+\" : \"\") + power.toString();\n    return this._formatNumberCore(number, \"fixedpoint\", formatConfig) + \"E\" + powString;\n  },\n  _addZeroes: function _addZeroes(value, precision) {\n    var multiplier = Math.pow(10, precision);\n    var sign = value < 0 ? \"-\" : \"\";\n    value = (Math.abs(value) * multiplier >>> 0) / multiplier;\n    var result = value.toString();\n\n    while (result.length < precision) {\n      result = \"0\" + result;\n    }\n\n    return sign + result;\n  },\n  _addGroupSeparators: function _addGroupSeparators(value) {\n    var parts = value.toString().split(\".\");\n    return parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, config().thousandsSeparator) + (parts[1] ? config().decimalSeparator + parts[1] : \"\");\n  },\n  _formatNumberCore: function _formatNumberCore(value, format, formatConfig) {\n    if (\"exponential\" === format) {\n      return this._formatNumberExponential(value, formatConfig);\n    }\n\n    if (\"decimal\" !== format && null !== formatConfig.precision) {\n      formatConfig.precision = formatConfig.precision || 0;\n    }\n\n    if (\"percent\" === format) {\n      value *= 100;\n    }\n\n    if (void 0 !== formatConfig.precision) {\n      if (\"decimal\" === format) {\n        value = this._addZeroes(value, formatConfig.precision);\n      } else {\n        value = null === formatConfig.precision ? value.toPrecision() : toFixed(value, formatConfig.precision);\n      }\n    }\n\n    if (\"decimal\" !== format) {\n      value = this._addGroupSeparators(value);\n    } else {\n      value = value.toString().replace(\".\", config().decimalSeparator);\n    }\n\n    if (\"percent\" === format) {\n      value += \"%\";\n    }\n\n    return value;\n  },\n  _normalizeFormat: function _normalizeFormat(format) {\n    if (!format) {\n      return {};\n    }\n\n    if (\"function\" === typeof format) {\n      return format;\n    }\n\n    if (!isPlainObject(format)) {\n      format = {\n        type: format\n      };\n    }\n\n    return format;\n  },\n  _getSeparators: function _getSeparators() {\n    return {\n      decimalSeparator: this.getDecimalSeparator(),\n      thousandsSeparator: this.getThousandsSeparator()\n    };\n  },\n  getThousandsSeparator: function getThousandsSeparator() {\n    return this.format(1e4, \"fixedPoint\")[2];\n  },\n  getDecimalSeparator: function getDecimalSeparator() {\n    return this.format(1.2, {\n      type: \"fixedPoint\",\n      precision: 1\n    })[1];\n  },\n  convertDigits: function convertDigits(value, toStandard) {\n    var digits = this.format(90, \"decimal\");\n\n    if (\"string\" !== typeof value || \"0\" === digits[1]) {\n      return value;\n    }\n\n    var fromFirstDigit = toStandard ? digits[1] : \"0\";\n    var toFirstDigit = toStandard ? \"0\" : digits[1];\n    var fromLastDigit = toStandard ? digits[0] : \"9\";\n    var regExp = new RegExp(\"[\" + fromFirstDigit + \"-\" + fromLastDigit + \"]\", \"g\");\n    return value.replace(regExp, function (char) {\n      return String.fromCharCode(char.charCodeAt(0) + (toFirstDigit.charCodeAt(0) - fromFirstDigit.charCodeAt(0)));\n    });\n  },\n  getNegativeEtalonRegExp: function getNegativeEtalonRegExp(format) {\n    var separators = this._getSeparators();\n\n    var digitalRegExp = new RegExp(\"[0-9\" + escapeRegExp(separators.decimalSeparator + separators.thousandsSeparator) + \"]+\", \"g\");\n    var negativeEtalon = this.format(-1, format).replace(digitalRegExp, \"1\");\n    [\"\\\\\", \"(\", \")\", \"[\", \"]\", \"*\", \"+\", \"$\", \"^\", \"?\", \"|\", \"{\", \"}\"].forEach(function (char) {\n      negativeEtalon = negativeEtalon.replaceAll(char, \"\\\\\".concat(char));\n    });\n    negativeEtalon = negativeEtalon.replaceAll(\" \", \"\\\\s\");\n    negativeEtalon = negativeEtalon.replaceAll(\"1\", \".+\");\n    return new RegExp(negativeEtalon, \"g\");\n  },\n  getSign: function getSign(text, format) {\n    if (!format) {\n      if (\"-\" === text.replace(/[^0-9-]/g, \"\").charAt(0)) {\n        return -1;\n      }\n\n      return 1;\n    }\n\n    var negativeEtalon = this.getNegativeEtalonRegExp(format);\n    return text.match(negativeEtalon) ? -1 : 1;\n  },\n  format: function format(value, _format) {\n    if (\"number\" !== typeof value) {\n      return value;\n    }\n\n    if (\"number\" === typeof _format) {\n      return value;\n    }\n\n    _format = _format && _format.formatter || _format;\n\n    if (\"function\" === typeof _format) {\n      return _format(value);\n    }\n\n    _format = this._normalizeFormat(_format);\n\n    if (!_format.type) {\n      _format.type = \"decimal\";\n    }\n\n    var numberConfig = this._parseNumberFormatString(_format.type);\n\n    if (!numberConfig) {\n      var formatterConfig = this._getSeparators();\n\n      formatterConfig.unlimitedIntegerDigits = _format.unlimitedIntegerDigits;\n      return this.convertDigits(getFormatter(_format.type, formatterConfig)(value));\n    }\n\n    return this._formatNumber(value, numberConfig, _format);\n  },\n  parse: function parse(text, format) {\n    if (!text) {\n      return;\n    }\n\n    if (format && format.parser) {\n      return format.parser(text);\n    }\n\n    text = this.convertDigits(text, true);\n\n    if (format && \"string\" !== typeof format) {\n      errors.log(\"W0011\");\n    }\n\n    var decimalSeparator = this.getDecimalSeparator();\n    var regExp = new RegExp(\"[^0-9\" + escapeRegExp(decimalSeparator) + \"]\", \"g\");\n    var cleanedText = text.replace(regExp, \"\").replace(decimalSeparator, \".\").replace(/\\.$/g, \"\");\n\n    if (\".\" === cleanedText || \"\" === cleanedText) {\n      return null;\n    }\n\n    if (this._calcSignificantDigits(cleanedText) > 15) {\n      return NaN;\n    }\n\n    var parsed = +cleanedText * this.getSign(text, format);\n    format = this._normalizeFormat(format);\n\n    var formatConfig = this._parseNumberFormatString(format.type);\n\n    var power = null === formatConfig || void 0 === formatConfig ? void 0 : formatConfig.power;\n\n    if (power) {\n      if (\"auto\" === power) {\n        var match = text.match(/\\d(K|M|B|T)/);\n\n        if (match) {\n          power = find(Object.keys(LargeNumberFormatPostfixes), function (power) {\n            return LargeNumberFormatPostfixes[power] === match[1];\n          });\n        }\n      }\n\n      parsed *= Math.pow(10, 3 * power);\n    }\n\n    if (\"percent\" === (null === formatConfig || void 0 === formatConfig ? void 0 : formatConfig.formatType)) {\n      parsed /= 100;\n    }\n\n    return parsed;\n  },\n  _calcSignificantDigits: function _calcSignificantDigits(text) {\n    var _text$split = text.split(\".\"),\n        _text$split2 = _slicedToArray(_text$split, 2),\n        integer = _text$split2[0],\n        fractional = _text$split2[1];\n\n    var calcDigitsAfterLeadingZeros = function calcDigitsAfterLeadingZeros(digits) {\n      var index = -1;\n\n      for (var i = 0; i < digits.length; i++) {\n        if (\"0\" !== digits[i]) {\n          index = i;\n          break;\n        }\n      }\n\n      return index > -1 ? digits.length - index : 0;\n    };\n\n    var result = 0;\n\n    if (integer) {\n      result += calcDigitsAfterLeadingZeros(integer.split(\"\"));\n    }\n\n    if (fractional) {\n      result += calcDigitsAfterLeadingZeros(fractional.split(\"\").reverse());\n    }\n\n    return result;\n  }\n});\nnumberLocalization.inject(currencyLocalization);\n\nif (hasIntl) {\n  numberLocalization.inject(intlNumberLocalization);\n}\n\nexport default numberLocalization;","map":null,"metadata":{},"sourceType":"module"}