{"ast":null,"code":"import _inherits from \"/Users/tonyshen/beacon-pro/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/tonyshen/beacon-pro/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _classCallCheck from \"/Users/tonyshen/beacon-pro/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/tonyshen/beacon-pro/node_modules/@babel/runtime/helpers/esm/createClass.js\";\n\n/**\r\n * DevExtreme (esm/ui/scheduler/workspaces/helpers/positionHelper.js)\r\n * Version: 21.2.6\r\n * Build date: Tue Mar 01 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\n\nvar getCellSize = function getCellSize(DOMMetaData) {\n  var dateTableCellsMeta = DOMMetaData.dateTableCellsMeta;\n  var length = null === dateTableCellsMeta || void 0 === dateTableCellsMeta ? void 0 : dateTableCellsMeta.length;\n\n  if (!length) {\n    return {\n      width: 0,\n      height: 0\n    };\n  }\n\n  var cellIndex = length > 1 ? 1 : 0;\n  var cellSize = dateTableCellsMeta[cellIndex][0];\n  return {\n    width: cellSize.width,\n    height: cellSize.height\n  };\n};\n\nvar getMaxAllowedHorizontalPosition = function getMaxAllowedHorizontalPosition(groupIndex, viewDataProvider, rtlEnabled, DOMMetaData) {\n  var dateTableCellsMeta = DOMMetaData.dateTableCellsMeta;\n  var firstRow = dateTableCellsMeta[0];\n\n  if (!firstRow) {\n    return 0;\n  }\n\n  var _viewDataProvider$get = viewDataProvider.getLastGroupCellPosition(groupIndex),\n      columnIndex = _viewDataProvider$get.columnIndex;\n\n  var cellPosition = firstRow[columnIndex];\n\n  if (!cellPosition) {\n    return 0;\n  }\n\n  return !rtlEnabled ? cellPosition.left + cellPosition.width : cellPosition.left;\n};\n\nexport var getCellHeight = function getCellHeight(DOMMetaData) {\n  return getCellSize(DOMMetaData).height;\n};\nexport var getCellWidth = function getCellWidth(DOMMetaData) {\n  return getCellSize(DOMMetaData).width;\n};\nexport var getAllDayHeight = function getAllDayHeight(showAllDayPanel, isVerticalGrouping, DOMMetaData) {\n  if (!showAllDayPanel) {\n    return 0;\n  }\n\n  if (isVerticalGrouping) {\n    var dateTableCellsMeta = DOMMetaData.dateTableCellsMeta;\n    var length = null === dateTableCellsMeta || void 0 === dateTableCellsMeta ? void 0 : dateTableCellsMeta.length;\n    return length ? dateTableCellsMeta[0][0].height : 0;\n  }\n\n  var allDayPanelCellsMeta = DOMMetaData.allDayPanelCellsMeta;\n  return null !== allDayPanelCellsMeta && void 0 !== allDayPanelCellsMeta && allDayPanelCellsMeta.length ? allDayPanelCellsMeta[0].height : 0;\n};\nexport var getMaxAllowedPosition = function getMaxAllowedPosition(groupIndex, viewDataProvider, rtlEnabled, DOMMetaData) {\n  var validGroupIndex = groupIndex || 0;\n  return getMaxAllowedHorizontalPosition(validGroupIndex, viewDataProvider, rtlEnabled, DOMMetaData);\n};\nexport var getGroupWidth = function getGroupWidth(groupIndex, viewDataProvider, options) {\n  var isVirtualScrolling = options.isVirtualScrolling,\n      rtlEnabled = options.rtlEnabled,\n      DOMMetaData = options.DOMMetaData;\n  var cellWidth = getCellWidth(DOMMetaData);\n  var result = viewDataProvider.getCellCount(options) * cellWidth;\n\n  if (isVirtualScrolling) {\n    var groupedData = viewDataProvider.groupedDataMap.dateTableGroupedMap;\n    var groupLength = groupedData[groupIndex][0].length;\n    result = groupLength * cellWidth;\n  }\n\n  var position = getMaxAllowedPosition(groupIndex, viewDataProvider, rtlEnabled, DOMMetaData);\n  var currentPosition = position[groupIndex];\n\n  if (currentPosition) {\n    if (rtlEnabled) {\n      result = currentPosition - position[groupIndex + 1];\n    } else if (0 === groupIndex) {\n      result = currentPosition;\n    } else {\n      result = currentPosition - position[groupIndex - 1];\n    }\n  }\n\n  return result;\n};\nexport var PositionHelper = /*#__PURE__*/function () {\n  function PositionHelper(options) {\n    _classCallCheck(this, PositionHelper);\n\n    this.options = options;\n    this.groupStrategy = this.options.isVerticalGrouping ? new GroupStrategyBase(this.options) : new GroupStrategyHorizontal(this.options);\n  }\n\n  _createClass(PositionHelper, [{\n    key: \"viewDataProvider\",\n    get: function get() {\n      return this.options.viewDataProvider;\n    }\n  }, {\n    key: \"rtlEnabled\",\n    get: function get() {\n      return this.options.rtlEnabled;\n    }\n  }, {\n    key: \"isGroupedByDate\",\n    get: function get() {\n      return this.options.isGroupedByDate;\n    }\n  }, {\n    key: \"groupCount\",\n    get: function get() {\n      return this.options.groupCount;\n    }\n  }, {\n    key: \"DOMMetaData\",\n    get: function get() {\n      return this.options.getDOMMetaDataCallback();\n    }\n  }, {\n    key: \"getHorizontalMax\",\n    value: function getHorizontalMax(groupIndex) {\n      var _this = this;\n\n      var getMaxPosition = function getMaxPosition(groupIndex) {\n        return getMaxAllowedPosition(groupIndex, _this.viewDataProvider, _this.rtlEnabled, _this.DOMMetaData);\n      };\n\n      if (this.isGroupedByDate) {\n        var viewPortGroupCount = this.viewDataProvider.getViewPortGroupCount();\n        return Math.max(getMaxPosition(groupIndex), getMaxPosition(viewPortGroupCount - 1));\n      }\n\n      return getMaxPosition(groupIndex);\n    }\n  }, {\n    key: \"getResizableStep\",\n    value: function getResizableStep() {\n      var cellWidth = getCellWidth(this.DOMMetaData);\n\n      if (this.isGroupedByDate) {\n        return this.groupCount * cellWidth;\n      }\n\n      return cellWidth;\n    }\n  }, {\n    key: \"getVerticalMax\",\n    value: function getVerticalMax(options) {\n      return this.groupStrategy.getVerticalMax(options);\n    }\n  }, {\n    key: \"getOffsetByAllDayPanel\",\n    value: function getOffsetByAllDayPanel(options) {\n      return this.groupStrategy.getOffsetByAllDayPanel(options);\n    }\n  }, {\n    key: \"getGroupTop\",\n    value: function getGroupTop(options) {\n      return this.groupStrategy.getGroupTop(options);\n    }\n  }]);\n\n  return PositionHelper;\n}();\n\nvar GroupStrategyBase = /*#__PURE__*/function () {\n  function GroupStrategyBase(options) {\n    _classCallCheck(this, GroupStrategyBase);\n\n    this.options = options;\n  }\n\n  _createClass(GroupStrategyBase, [{\n    key: \"viewDataProvider\",\n    get: function get() {\n      return this.options.viewDataProvider;\n    }\n  }, {\n    key: \"isGroupedByDate\",\n    get: function get() {\n      return this.options.isGroupedByDate;\n    }\n  }, {\n    key: \"rtlEnabled\",\n    get: function get() {\n      return this.options.rtlEnabled;\n    }\n  }, {\n    key: \"groupCount\",\n    get: function get() {\n      return this.options.groupCount;\n    }\n  }, {\n    key: \"DOMMetaData\",\n    get: function get() {\n      return this.options.getDOMMetaDataCallback();\n    }\n  }, {\n    key: \"getOffsetByAllDayPanel\",\n    value: function getOffsetByAllDayPanel(_ref) {\n      var groupIndex = _ref.groupIndex,\n          supportAllDayRow = _ref.supportAllDayRow,\n          showAllDayPanel = _ref.showAllDayPanel;\n      var result = 0;\n\n      if (supportAllDayRow && showAllDayPanel) {\n        var allDayPanelHeight = getAllDayHeight(showAllDayPanel, true, this.DOMMetaData);\n        result = allDayPanelHeight * (groupIndex + 1);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"getVerticalMax\",\n    value: function getVerticalMax(options) {\n      var maxAllowedPosition = this._getMaxAllowedVerticalPosition(_extends({}, options, {\n        viewDataProvider: this.viewDataProvider,\n        rtlEnabled: this.rtlEnabled,\n        DOMMetaData: this.DOMMetaData\n      }));\n\n      maxAllowedPosition += this.getOffsetByAllDayPanel(options);\n      return maxAllowedPosition;\n    }\n  }, {\n    key: \"getGroupTop\",\n    value: function getGroupTop(_ref2) {\n      var groupIndex = _ref2.groupIndex,\n          showAllDayPanel = _ref2.showAllDayPanel,\n          isGroupedAllDayPanel = _ref2.isGroupedAllDayPanel;\n      var rowCount = this.viewDataProvider.getRowCountInGroup(groupIndex);\n\n      var maxVerticalPosition = this._getMaxAllowedVerticalPosition({\n        groupIndex: groupIndex,\n        viewDataProvider: this.viewDataProvider,\n        showAllDayPanel: showAllDayPanel,\n        isGroupedAllDayPanel: isGroupedAllDayPanel,\n        isVerticalGrouping: true,\n        DOMMetaData: this.DOMMetaData\n      });\n\n      return maxVerticalPosition - getCellHeight(this.DOMMetaData) * rowCount;\n    }\n  }, {\n    key: \"_getAllDayHeight\",\n    value: function _getAllDayHeight(showAllDayPanel) {\n      return getAllDayHeight(showAllDayPanel, true, this.DOMMetaData);\n    }\n  }, {\n    key: \"_getMaxAllowedVerticalPosition\",\n    value: function _getMaxAllowedVerticalPosition(_ref3) {\n      var groupIndex = _ref3.groupIndex,\n          showAllDayPanel = _ref3.showAllDayPanel,\n          isGroupedAllDayPanel = _ref3.isGroupedAllDayPanel;\n\n      var _this$viewDataProvide = this.viewDataProvider.getLastGroupCellPosition(groupIndex),\n          rowIndex = _this$viewDataProvide.rowIndex;\n\n      var dateTableCellsMeta = this.DOMMetaData.dateTableCellsMeta;\n      var lastGroupRow = dateTableCellsMeta[rowIndex];\n\n      if (!lastGroupRow) {\n        return 0;\n      }\n\n      var result = lastGroupRow[0].top + lastGroupRow[0].height;\n\n      if (isGroupedAllDayPanel) {\n        result -= (groupIndex + 1) * this._getAllDayHeight(showAllDayPanel);\n      }\n\n      return result;\n    }\n  }]);\n\n  return GroupStrategyBase;\n}();\n\nvar GroupStrategyHorizontal = /*#__PURE__*/function (_GroupStrategyBase) {\n  _inherits(GroupStrategyHorizontal, _GroupStrategyBase);\n\n  var _super = _createSuper(GroupStrategyHorizontal);\n\n  function GroupStrategyHorizontal() {\n    _classCallCheck(this, GroupStrategyHorizontal);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(GroupStrategyHorizontal, [{\n    key: \"getOffsetByAllDayPanel\",\n    value: function getOffsetByAllDayPanel(options) {\n      return 0;\n    }\n  }, {\n    key: \"getVerticalMax\",\n    value: function getVerticalMax(options) {\n      var isVirtualScrolling = options.isVirtualScrolling,\n          groupIndex = options.groupIndex;\n      var correctedGroupIndex = isVirtualScrolling ? groupIndex : 0;\n      return this._getMaxAllowedVerticalPosition(_extends({}, options, {\n        groupIndex: correctedGroupIndex\n      }));\n    }\n  }, {\n    key: \"getGroupTop\",\n    value: function getGroupTop(options) {\n      return 0;\n    }\n  }, {\n    key: \"_getAllDayHeight\",\n    value: function _getAllDayHeight(showAllDayPanel) {\n      return getAllDayHeight(showAllDayPanel, false, this.DOMMetaData);\n    }\n  }]);\n\n  return GroupStrategyHorizontal;\n}(GroupStrategyBase);","map":null,"metadata":{},"sourceType":"module"}