{"ast":null,"code":"import _classCallCheck from \"/Users/tonyshen/beacon-pro/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/tonyshen/beacon-pro/node_modules/@babel/runtime/helpers/esm/createClass.js\";\n\n/**\r\n * DevExtreme (esm/ui/overlay/overlay_position_controller.js)\r\n * Version: 21.2.6\r\n * Build date: Tue Mar 01 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../../core/renderer\";\nimport { isDefined, isString, isEvent, isWindow } from \"../../core/utils/type\";\nimport { extend } from \"../../core/utils/extend\";\nimport positionUtils from \"../../animation/position\";\nimport { resetPosition, move, locate } from \"../../animation/translator\";\nimport { getWindow } from \"../../core/utils/window\";\nimport { originalViewPort, value as viewPort } from \"../../core/utils/view_port\";\nvar window = getWindow();\nvar OVERLAY_POSITION_ALIASES = {\n  top: {\n    my: \"top center\",\n    at: \"top center\"\n  },\n  bottom: {\n    my: \"bottom center\",\n    at: \"bottom center\"\n  },\n  right: {\n    my: \"right center\",\n    at: \"right center\"\n  },\n  left: {\n    my: \"left center\",\n    at: \"left center\"\n  },\n  center: {\n    my: \"center\",\n    at: \"center\"\n  },\n  \"right bottom\": {\n    my: \"right bottom\",\n    at: \"right bottom\"\n  },\n  \"right top\": {\n    my: \"right top\",\n    at: \"right top\"\n  },\n  \"left bottom\": {\n    my: \"left bottom\",\n    at: \"left bottom\"\n  },\n  \"left top\": {\n    my: \"left top\",\n    at: \"left top\"\n  }\n};\nvar OVERLAY_DEFAULT_BOUNDARY_OFFSET = {\n  h: 0,\n  v: 0\n};\n\nvar OverlayPositionController = /*#__PURE__*/function () {\n  function OverlayPositionController(_ref) {\n    _classCallCheck(this, OverlayPositionController);\n\n    var position = _ref.position,\n        target = _ref.target,\n        container = _ref.container,\n        $root = _ref.$root,\n        $content = _ref.$content,\n        $wrapper = _ref.$wrapper,\n        onPositioned = _ref.onPositioned,\n        onVisualPositionChanged = _ref.onVisualPositionChanged,\n        dragOutsideBoundary = _ref.dragOutsideBoundary,\n        dragAndResizeArea = _ref.dragAndResizeArea,\n        outsideDragFactor = _ref.outsideDragFactor,\n        restorePosition = _ref.restorePosition,\n        _fixWrapperPosition = _ref._fixWrapperPosition;\n    this._props = {\n      position: position,\n      target: target,\n      container: container,\n      dragOutsideBoundary: dragOutsideBoundary,\n      dragAndResizeArea: dragAndResizeArea,\n      outsideDragFactor: outsideDragFactor,\n      restorePosition: restorePosition,\n      onPositioned: onPositioned,\n      onVisualPositionChanged: onVisualPositionChanged,\n      _fixWrapperPosition: _fixWrapperPosition\n    };\n    this._$root = $root;\n    this._$content = $content;\n    this._$wrapper = $wrapper;\n    this._$markupContainer = void 0;\n    this._$wrapperCoveredElement = void 0;\n    this._shouldRenderContentInitialPosition = true;\n    this._visualPosition = void 0;\n    this._initialPosition = void 0;\n    this._previousVisualPosition = void 0;\n    this._$dragResizeContainer = void 0;\n    this._outsideDragFactor = void 0;\n    this.updateContainer(container);\n    this.updatePosition(position, target);\n\n    this._updateDragResizeContainer();\n\n    this._updateOutsideDragFactor();\n  }\n\n  _createClass(OverlayPositionController, [{\n    key: \"$container\",\n    get: function get() {\n      return this._$markupContainer;\n    }\n  }, {\n    key: \"$dragResizeContainer\",\n    get: function get() {\n      return this._$dragResizeContainer;\n    }\n  }, {\n    key: \"outsideDragFactor\",\n    get: function get() {\n      return this._outsideDragFactor;\n    },\n    set: function set(outsideDragFactor) {\n      this._props.outsideDragFactor = outsideDragFactor;\n\n      this._updateOutsideDragFactor();\n    }\n  }, {\n    key: \"fixWrapperPosition\",\n    set: function set(fixWrapperPosition) {\n      this._props._fixWrapperPosition = fixWrapperPosition;\n      this.styleWrapperPosition();\n    }\n  }, {\n    key: \"dragAndResizeArea\",\n    set: function set(dragAndResizeArea) {\n      this._props.dragAndResizeArea = dragAndResizeArea;\n\n      this._updateDragResizeContainer();\n    }\n  }, {\n    key: \"dragOutsideBoundary\",\n    set: function set(dragOutsideBoundary) {\n      this._props.dragOutsideBoundary = dragOutsideBoundary;\n\n      this._updateDragResizeContainer();\n\n      this._updateOutsideDragFactor();\n    }\n  }, {\n    key: \"restorePosition\",\n    set: function set(restorePosition) {\n      this._props.restorePosition = restorePosition;\n    }\n  }, {\n    key: \"restorePositionOnNextRender\",\n    value: function restorePositionOnNextRender(value) {\n      this._shouldRenderContentInitialPosition = value || !this._visualPosition;\n    }\n  }, {\n    key: \"openingHandled\",\n    value: function openingHandled() {\n      var shouldRestorePosition = this._props.restorePosition;\n      this.restorePositionOnNextRender(shouldRestorePosition);\n    }\n  }, {\n    key: \"dragHandled\",\n    value: function dragHandled() {\n      this.restorePositionOnNextRender(false);\n    }\n  }, {\n    key: \"resizeHandled\",\n    value: function resizeHandled() {\n      this.restorePositionOnNextRender(false);\n    }\n  }, {\n    key: \"updateTarget\",\n    value: function updateTarget(target) {\n      this._props.target = target;\n      this.updatePosition(this._props.position, target);\n    }\n  }, {\n    key: \"updatePosition\",\n    value: function updatePosition(positionProp) {\n      var targetProp = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : this._props.target;\n      this._props.position = positionProp;\n      this._position = this._normalizePosition(positionProp, targetProp);\n\n      this._updateWrapperCoveredElement();\n    }\n  }, {\n    key: \"updateContainer\",\n    value: function updateContainer(containerProp) {\n      this._props.container = containerProp;\n      var container = null !== containerProp && void 0 !== containerProp ? containerProp : viewPort();\n\n      var $container = this._$root.closest(container);\n\n      if (!$container.length) {\n        $container = $(container).first();\n      }\n\n      this._$markupContainer = $container.length ? $container : this._$root.parent();\n\n      this._updateWrapperCoveredElement();\n\n      this._updateDragResizeContainer();\n    }\n  }, {\n    key: \"detectVisualPositionChange\",\n    value: function detectVisualPositionChange(event) {\n      this._updateVisualPositionValue();\n\n      this._raisePositionedEvents(event);\n    }\n  }, {\n    key: \"positionContent\",\n    value: function positionContent() {\n      if (this._shouldRenderContentInitialPosition) {\n        this._renderContentInitialPosition();\n      } else {\n        move(this._$content, this._visualPosition);\n        this.detectVisualPositionChange();\n      }\n    }\n  }, {\n    key: \"positionWrapper\",\n    value: function positionWrapper() {\n      if (this._$wrapperCoveredElement) {\n        positionUtils.setup(this._$wrapper, {\n          my: \"top left\",\n          at: \"top left\",\n          of: this._$wrapperCoveredElement\n        });\n      }\n    }\n  }, {\n    key: \"isAllWindowCoveredByWrapper\",\n    value: function isAllWindowCoveredByWrapper() {\n      return !this._$wrapperCoveredElement || isWindow(this._$wrapperCoveredElement.get(0));\n    }\n  }, {\n    key: \"styleWrapperPosition\",\n    value: function styleWrapperPosition() {\n      var useFixed = this.isAllWindowCoveredByWrapper() || this._props._fixWrapperPosition;\n\n      var positionStyle = useFixed ? \"fixed\" : \"absolute\";\n\n      this._$wrapper.css(\"position\", positionStyle);\n    }\n  }, {\n    key: \"_updateVisualPositionValue\",\n    value: function _updateVisualPositionValue() {\n      this._previousVisualPosition = this._visualPosition;\n      this._visualPosition = locate(this._$content);\n    }\n  }, {\n    key: \"_renderContentInitialPosition\",\n    value: function _renderContentInitialPosition() {\n      this._renderBoundaryOffset();\n\n      resetPosition(this._$content);\n\n      var wrapperOverflow = this._$wrapper.css(\"overflow\");\n\n      this._$wrapper.css(\"overflow\", \"hidden\");\n\n      var resultPosition = positionUtils.setup(this._$content, this._position);\n\n      this._$wrapper.css(\"overflow\", wrapperOverflow);\n\n      this._initialPosition = resultPosition;\n      this.detectVisualPositionChange();\n    }\n  }, {\n    key: \"_raisePositionedEvents\",\n    value: function _raisePositionedEvents(event) {\n      var previousPosition = this._previousVisualPosition;\n      var newPosition = this._visualPosition;\n      var isVisualPositionChanged = (null === previousPosition || void 0 === previousPosition ? void 0 : previousPosition.top) !== newPosition.top || (null === previousPosition || void 0 === previousPosition ? void 0 : previousPosition.left) !== newPosition.left;\n\n      if (isVisualPositionChanged) {\n        this._props.onVisualPositionChanged({\n          previousPosition: previousPosition,\n          position: newPosition,\n          event: event\n        });\n      }\n\n      this._props.onPositioned({\n        position: this._initialPosition\n      });\n    }\n  }, {\n    key: \"_updateOutsideDragFactor\",\n    value: function _updateOutsideDragFactor() {\n      this._outsideDragFactor = this._getOutsideDragFactor();\n    }\n  }, {\n    key: \"_getOutsideDragFactor\",\n    value: function _getOutsideDragFactor() {\n      if (this._props.dragOutsideBoundary) {\n        return 1;\n      }\n\n      return this._props.outsideDragFactor;\n    }\n  }, {\n    key: \"_updateDragResizeContainer\",\n    value: function _updateDragResizeContainer() {\n      this._$dragResizeContainer = this._getDragResizeContainer();\n    }\n  }, {\n    key: \"_getDragResizeContainer\",\n    value: function _getDragResizeContainer() {\n      if (this._props.dragOutsideBoundary) {\n        return $(window);\n      }\n\n      if (this._props.dragAndResizeArea) {\n        return $(this._props.dragAndResizeArea);\n      }\n\n      var isContainerDefined = originalViewPort().get(0) || this._props.container;\n\n      return isContainerDefined ? this._$markupContainer : $(window);\n    }\n  }, {\n    key: \"_updateWrapperCoveredElement\",\n    value: function _updateWrapperCoveredElement() {\n      this._$wrapperCoveredElement = this._getWrapperCoveredElement();\n    }\n  }, {\n    key: \"_renderBoundaryOffset\",\n    value: function _renderBoundaryOffset() {\n      var _this$_position;\n\n      var boundaryOffset = null !== (_this$_position = this._position) && void 0 !== _this$_position ? _this$_position : {\n        boundaryOffset: OVERLAY_DEFAULT_BOUNDARY_OFFSET\n      };\n\n      this._$content.css(\"margin\", \"\".concat(boundaryOffset.v, \"px \").concat(boundaryOffset.h, \"px\"));\n    }\n  }, {\n    key: \"_getWrapperCoveredElement\",\n    value: function _getWrapperCoveredElement() {\n      var containerProp = this._props.container;\n\n      if (containerProp) {\n        return $(containerProp);\n      }\n\n      if (this._position) {\n        return $(isEvent(this._position.of) ? window : this._position.of || window);\n      }\n    }\n  }, {\n    key: \"_normalizePosition\",\n    value: function _normalizePosition(positionProp, targetProp) {\n      var defaultPositionConfig = {\n        of: targetProp,\n        boundaryOffset: OVERLAY_DEFAULT_BOUNDARY_OFFSET\n      };\n\n      if (isDefined(positionProp)) {\n        return extend(true, {}, defaultPositionConfig, this._positionToObject(positionProp));\n      } else {\n        return defaultPositionConfig;\n      }\n    }\n  }, {\n    key: \"_positionToObject\",\n    value: function _positionToObject(position) {\n      if (isString(position)) {\n        return extend({}, OVERLAY_POSITION_ALIASES[position]);\n      }\n\n      return position;\n    }\n  }]);\n\n  return OverlayPositionController;\n}();\n\nexport { OVERLAY_POSITION_ALIASES, OverlayPositionController };","map":null,"metadata":{},"sourceType":"module"}