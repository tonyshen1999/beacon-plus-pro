{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/action_sheet.js)\r\n * Version: 21.2.6\r\n * Build date: Tue Mar 01 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../core/renderer\";\nimport { getWindow } from \"../core/utils/window\";\nvar window = getWindow();\nimport { noop } from \"../core/utils/common\";\nimport messageLocalization from \"../localization/message\";\nimport registerComponent from \"../core/component_registrator\";\nimport { extend } from \"../core/utils/extend\";\nimport Button from \"./button\";\nimport CollectionWidget from \"./collection/ui.collection_widget.edit\";\nimport Popup from \"./popup\";\nimport Popover from \"./popover\";\nimport { BindableTemplate } from \"../core/templates/bindable_template\";\nimport { Deferred } from \"../core/utils/deferred\";\nvar ACTION_SHEET_CLASS = \"dx-actionsheet\";\nvar ACTION_SHEET_CONTAINER_CLASS = \"dx-actionsheet-container\";\nvar ACTION_SHEET_POPUP_WRAPPER_CLASS = \"dx-actionsheet-popup-wrapper\";\nvar ACTION_SHEET_POPOVER_WRAPPER_CLASS = \"dx-actionsheet-popover-wrapper\";\nvar ACTION_SHEET_CANCEL_BUTTON_CLASS = \"dx-actionsheet-cancel\";\nvar ACTION_SHEET_ITEM_CLASS = \"dx-actionsheet-item\";\nvar ACTION_SHEET_ITEM_DATA_KEY = \"dxActionSheetItemData\";\nvar ACTION_SHEET_WITHOUT_TITLE_CLASS = \"dx-actionsheet-without-title\";\nvar ACTION_SHEET_BUTTON_DEFAULT_STYLING_MODE = \"outlined\";\nvar ActionSheet = CollectionWidget.inherit({\n  _getDefaultOptions: function _getDefaultOptions() {\n    return extend(this.callBase(), {\n      usePopover: false,\n      target: null,\n      title: \"\",\n      showTitle: true,\n      showCancelButton: true,\n      cancelText: messageLocalization.format(\"Cancel\"),\n      onCancelClick: null,\n      visible: false,\n      noDataText: \"\",\n      focusStateEnabled: false,\n      selectionByClick: false\n    });\n  },\n  _defaultOptionsRules: function _defaultOptionsRules() {\n    return this.callBase().concat([{\n      device: {\n        platform: \"ios\",\n        tablet: true\n      },\n      options: {\n        usePopover: true\n      }\n    }]);\n  },\n  _initTemplates: function _initTemplates() {\n    this.callBase();\n\n    this._templateManager.addDefaultTemplates({\n      item: new BindableTemplate(function ($container, data) {\n        var button = new Button($(\"<div>\"), extend({\n          onClick: data && data.click,\n          stylingMode: data && data.stylingMode || ACTION_SHEET_BUTTON_DEFAULT_STYLING_MODE\n        }, data));\n        $container.append(button.$element());\n      }, [\"disabled\", \"icon\", \"text\", \"type\", \"onClick\", \"click\", \"stylingMode\"], this.option(\"integrationOptions.watchMethod\"))\n    });\n  },\n  _itemContainer: function _itemContainer() {\n    return this._$itemContainer;\n  },\n  _itemClass: function _itemClass() {\n    return ACTION_SHEET_ITEM_CLASS;\n  },\n  _itemDataKey: function _itemDataKey() {\n    return ACTION_SHEET_ITEM_DATA_KEY;\n  },\n  _toggleVisibility: noop,\n  _renderDimensions: noop,\n  _initMarkup: function _initMarkup() {\n    this.callBase();\n    this.$element().addClass(ACTION_SHEET_CLASS);\n\n    this._createItemContainer();\n  },\n  _render: function _render() {\n    this._renderPopup();\n  },\n  _createItemContainer: function _createItemContainer() {\n    this._$itemContainer = $(\"<div>\").addClass(ACTION_SHEET_CONTAINER_CLASS);\n\n    this._renderDisabled();\n  },\n  _renderDisabled: function _renderDisabled() {\n    this._$itemContainer.toggleClass(\"dx-state-disabled\", this.option(\"disabled\"));\n  },\n  _renderPopup: function _renderPopup() {\n    this._$popup = $(\"<div>\").appendTo(this.$element());\n    this._isPopoverMode() ? this._createPopover() : this._createPopup();\n\n    this._renderPopupTitle();\n\n    this._mapPopupOption(\"visible\");\n  },\n  _mapPopupOption: function _mapPopupOption(optionName) {\n    this._popup && this._popup.option(optionName, this.option(optionName));\n  },\n  _isPopoverMode: function _isPopoverMode() {\n    return this.option(\"usePopover\") && this.option(\"target\");\n  },\n  _renderPopupTitle: function _renderPopupTitle() {\n    this._mapPopupOption(\"showTitle\");\n\n    this._popup && this._popup.$wrapper().toggleClass(ACTION_SHEET_WITHOUT_TITLE_CLASS, !this.option(\"showTitle\"));\n  },\n  _clean: function _clean() {\n    if (this._$popup) {\n      this._$popup.remove();\n    }\n\n    this.callBase();\n  },\n  _overlayConfig: function _overlayConfig() {\n    return {\n      onInitialized: function (args) {\n        this._popup = args.component;\n      }.bind(this),\n      disabled: false,\n      showTitle: true,\n      title: this.option(\"title\"),\n      deferRendering: !window.angular,\n      onContentReady: this._popupContentReadyAction.bind(this),\n      onHidden: this.hide.bind(this)\n    };\n  },\n  _createPopover: function _createPopover() {\n    this._createComponent(this._$popup, Popover, extend(this._overlayConfig(), {\n      width: this.option(\"width\") || 200,\n      height: this.option(\"height\") || \"auto\",\n      target: this.option(\"target\")\n    }));\n\n    this._popup.$wrapper().addClass(ACTION_SHEET_POPOVER_WRAPPER_CLASS);\n  },\n  _createPopup: function _createPopup() {\n    this._createComponent(this._$popup, Popup, extend(this._overlayConfig(), {\n      dragEnabled: false,\n      width: this.option(\"width\") || \"100%\",\n      height: this.option(\"height\") || \"auto\",\n      showCloseButton: false,\n      position: {\n        my: \"bottom\",\n        at: \"bottom\",\n        of: window\n      },\n      animation: {\n        show: {\n          type: \"slide\",\n          duration: 400,\n          from: {\n            position: {\n              my: \"top\",\n              at: \"bottom\",\n              of: window\n            }\n          },\n          to: {\n            position: {\n              my: \"bottom\",\n              at: \"bottom\",\n              of: window\n            }\n          }\n        },\n        hide: {\n          type: \"slide\",\n          duration: 400,\n          from: {\n            position: {\n              my: \"bottom\",\n              at: \"bottom\",\n              of: window\n            }\n          },\n          to: {\n            position: {\n              my: \"top\",\n              at: \"bottom\",\n              of: window\n            }\n          }\n        }\n      }\n    }));\n\n    this._popup.$wrapper().addClass(ACTION_SHEET_POPUP_WRAPPER_CLASS);\n  },\n  _popupContentReadyAction: function _popupContentReadyAction() {\n    this._popup.$content().append(this._$itemContainer);\n\n    this._attachClickEvent();\n\n    this._attachHoldEvent();\n\n    this._prepareContent();\n\n    this._renderContent();\n\n    this._renderCancelButton();\n  },\n  _renderCancelButton: function _renderCancelButton() {\n    if (this._isPopoverMode()) {\n      return;\n    }\n\n    if (this._$cancelButton) {\n      this._$cancelButton.remove();\n    }\n\n    if (this.option(\"showCancelButton\")) {\n      var cancelClickAction = this._createActionByOption(\"onCancelClick\") || noop;\n      var that = this;\n      this._$cancelButton = $(\"<div>\").addClass(ACTION_SHEET_CANCEL_BUTTON_CLASS).appendTo(this._popup && this._popup.$content());\n\n      this._createComponent(this._$cancelButton, Button, {\n        disabled: false,\n        stylingMode: ACTION_SHEET_BUTTON_DEFAULT_STYLING_MODE,\n        text: this.option(\"cancelText\"),\n        onClick: function onClick(e) {\n          var hidingArgs = {\n            event: e,\n            cancel: false\n          };\n          cancelClickAction(hidingArgs);\n\n          if (!hidingArgs.cancel) {\n            that.hide();\n          }\n        },\n        integrationOptions: {}\n      });\n    }\n  },\n  _attachItemClickEvent: noop,\n  _itemClickHandler: function _itemClickHandler(e) {\n    this.callBase(e);\n\n    if (!$(e.target).is(\".dx-state-disabled, .dx-state-disabled *\")) {\n      this.hide();\n    }\n  },\n  _itemHoldHandler: function _itemHoldHandler(e) {\n    this.callBase(e);\n\n    if (!$(e.target).is(\".dx-state-disabled, .dx-state-disabled *\")) {\n      this.hide();\n    }\n  },\n  _optionChanged: function _optionChanged(args) {\n    switch (args.name) {\n      case \"width\":\n      case \"height\":\n      case \"visible\":\n      case \"title\":\n        this._mapPopupOption(args.name);\n\n        break;\n\n      case \"disabled\":\n        this._renderDisabled();\n\n        break;\n\n      case \"showTitle\":\n        this._renderPopupTitle();\n\n        break;\n\n      case \"showCancelButton\":\n      case \"onCancelClick\":\n      case \"cancelText\":\n        this._renderCancelButton();\n\n        break;\n\n      case \"target\":\n      case \"usePopover\":\n      case \"items\":\n        this._invalidate();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  toggle: function toggle(showing) {\n    var that = this;\n    var d = new Deferred();\n\n    that._popup.toggle(showing).done(function () {\n      that.option(\"visible\", showing);\n      d.resolveWith(that);\n    });\n\n    return d.promise();\n  },\n  show: function show() {\n    return this.toggle(true);\n  },\n  hide: function hide() {\n    return this.toggle(false);\n  }\n});\nregisterComponent(\"dxActionSheet\", ActionSheet);\nexport default ActionSheet;","map":null,"metadata":{},"sourceType":"module"}